<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png"><link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png"><link href="/safari-pinned-tab.svg" rel="mask-icon" color="#3BA3E8"><link href="/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180"><meta content="width=device-width,initial-scale=1,shrink-to-fit=no" name="viewport"><meta content="#2d89ef" name="msapplication-TileColor"><meta content="#8a73ff" name="theme-color"><link href="/manifest.json" rel="manifest"><title>Geordie Powers</title><link href="/static/css/main.7e2b7afe.chunk.css" rel="stylesheet"><link href="https://giant.gfycat.com" rel="preconnect"><link href="/static/js/16.685cfdbc.chunk.js" rel="preload" as="script"><link href="/static/js/main.c79bbdec.chunk.js" rel="preload" as="script"><link href="/static/js/10.abf27806.chunk.js" rel="preload" as="script"><link href="/static/js/5.4600a1b2.chunk.js" rel="preload" as="script"><link href="/static/js/3.c7af5567.chunk.js" rel="preload" as="script"></head><body><div id="root"><div class="Layout Layout--standard fastFade"><nav class="u-flexH u-spaceBetween u-centerMain"><div><a href="/"><svg class="LogoSvg" enable-background="new 0 0 200 200" height="200px" id="Layer_1" version="1.1" viewBox="0 0 200 200" width="200px" x="0px" xml:space="preserve" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"><linearGradient gradientUnits="userSpaceOnUse" id="SVGID_1_" x1="148.8818" x2="51.1174" y1="15.3335" y2="184.6664"><stop offset="0" style="stop-color:#3ba3e8"></stop><stop offset="1" style="stop-color:#8a73ff"></stop></linearGradient><path d="M148.647,23.135c-28.3,0-51.244,22.944-51.244,51.243v9.72v31.804v9.72 c0,25.432-20.618,46.05-46.05,46.05c-25.432,0-46.051-20.618-46.051-46.05c0-25.432,20.619-46.051,46.051-46.051h28.576v-5.192 H51.353c-28.301,0-51.243,22.942-51.243,51.243s22.942,51.244,51.243,51.244s51.244-22.943,51.244-51.244v-9.72V84.098v-9.72 c0-25.432,20.617-46.05,46.051-46.05c25.433,0,46.05,20.618,46.05,46.05s-20.617,46.051-46.05,46.051h-28.576v5.192h28.576 c28.301,0,51.243-22.942,51.243-51.243C199.891,46.079,176.948,23.135,148.647,23.135z" fill="url(#SVGID_1_)"></path><rect fill="url(#SVGID_1_)" height="5.192" width="17.475" x="62.455" y="120.429"></rect></svg></a></div><div><a href="/projects">Projects</a><a href="/blog">Blog</a><a href="/contact">Contact</a></div></nav><main><div><h1 id="building-swift-shop---week-2-nov-23---30-2019">Building Swift Shop - Week 2 (Nov 23 − 30, 2019)</h1><h4 id="dec-1-2019">Dec 1, 2019</h4><p>Not a whole lot of progress this week, the evenings have been busier than normal.</p><p>One limitation of SwiftUI I’ve come across; It doesn’t currently seem possible to conditionally render the style of a view when the style is applied via an empty call chained on the view. <code>.strikethrough()</code> on the <code>Text</code> view is an example:</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">if</span> product<span class="token punctuation">.</span>complete <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">Text</span><span class="token punctuation">(</span>product<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">strikethrough</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">Text</span><span class="token punctuation">(</span>product<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><p>The return type of this <code>if</code> expression is different based on whether or not the <code>.strikethrough()</code> is present, so SwiftUI complains (showing the error in the parent view, for some reason):</p><pre><code>'VIEW_NAME.Type' is not convertible to '() -> VIEW_NAME'
</code></pre><p>The only way to do conditional styles is with methods that accept an argument, for example:</p><pre><code>Text(product.name)
  .foregroundColor(product.complete ? Color.gray : Color.black)
</code></pre><p>In this case we’re not calling the <code>.foregroundColor</code> method conditionally, so the return type stays the same. Only the foreground color argument changes.</p><h2 id="search-bar">Search Bar</h2><p>This week, the temporary buttons to add/remove a placeholder filter were replaced by a functioning search bar.</p><p>The search bar is a separate View, and it receives its filter manager from its parent View. It internally keeps a state variable for the value of the rendered input field, with an intermediate binding in the body to proxy the <code>set</code> functionality.</p><pre class="language-swift"><code class="language-swift"><span class="token keyword">struct</span> <span class="token builtin">ProductFilterBar</span><span class="token punctuation">:</span> <span class="token builtin">View</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> filterManager<span class="token punctuation">:</span> <span class="token builtin">FilterManager</span><span class="token operator">&lt;</span><span class="token builtin">Product</span><span class="token operator">></span>
  @<span class="token builtin">State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> searchValue<span class="token punctuation">:</span> <span class="token builtin">String</span> <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>

  <span class="token keyword">func</span> <span class="token function">setSearch</span><span class="token punctuation">(</span><span class="token number">_</span> fieldValue<span class="token punctuation">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">defer</span> <span class="token punctuation">{</span> <span class="token keyword">self</span><span class="token punctuation">.</span>searchValue <span class="token operator">=</span> fieldValue <span class="token punctuation">}</span>

    <span class="token keyword">if</span> fieldValue<span class="token punctuation">.</span><span class="token builtin">count</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
      <span class="token keyword">self</span><span class="token punctuation">.</span>filterManager<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">"SEARCH"</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">self</span><span class="token punctuation">.</span>filterManager<span class="token punctuation">.</span><span class="token function">upsert</span><span class="token punctuation">(</span><span class="token string">"SEARCH"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> product <span class="token keyword">in</span>
      product<span class="token punctuation">.</span>name
        <span class="token punctuation">.</span><span class="token function">lowercased</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>fieldValue<span class="token punctuation">.</span><span class="token function">lowercased</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">var</span> body<span class="token punctuation">:</span> some <span class="token builtin">View</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> boundSearchValue <span class="token operator">=</span> <span class="token builtin">Binding</span><span class="token operator">&lt;</span><span class="token builtin">String</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token keyword">get</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token keyword">self</span><span class="token punctuation">.</span>searchValue <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">set</span><span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">.</span>setSearch<span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token builtin">HStack</span> <span class="token punctuation">{</span>
      <span class="token function">TextField</span><span class="token punctuation">(</span><span class="token string">"Search for a product name"</span><span class="token punctuation">,</span> text<span class="token punctuation">:</span> boundSearchValue<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>When a user types a character in the text field, the <code>setSearch</code> function is called. We defer setting the state variable until the end of the scope, then decide how to update the “SEARCH” filter. The filter is removed when the field is empty, otherwise we update the filter with a new closure that compares a given product with the closed-over value of the text field.</p><h2 id="progress---week-2">Progress - Week 2</h2><ul><li>SwiftDux store and actions are mostly set up for Lists state</li><li>Added a real search bar to the products page:</li></ul><div align="center"><video alt="Week 2 Progress Video" controls><source src="https://giant.gfycat.com/ClassicSoupyBallpython.mp4" type="video/mp4"></video></div></div></main></div></div><script>!function(f){function e(e){for(var t,r,n=e[0],o=e[1],a=e[2],c=0,u=[];c<n.length;c++)r=n[c],d[r]&&u.push(d[r][0]),d[r]=0;for(t in o)Object.prototype.hasOwnProperty.call(o,t)&&(f[t]=o[t]);for(p&&p(e);u.length;)u.shift()();return l.push.apply(l,a||[]),i()}function i(){for(var e,t=0;t<l.length;t++){for(var r=l[t],n=!0,o=1;o<r.length;o++){var a=r[o];0!==d[a]&&(n=!1)}n&&(l.splice(t--,1),e=s(s.s=r[0]))}return e}var r={},u={17:0},d={17:0},l=[];function s(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return f[e].call(t.exports,t,t.exports,s),t.l=!0,t.exports}s.e=function(l){var e=[];u[l]?e.push(u[l]):0!==u[l]&&{2:1,6:1}[l]&&e.push(u[l]=new Promise(function(e,n){for(var t="static/css/"+({}[l]||l)+"."+{0:"31d6cfe0",2:"31d49b7e",3:"31d6cfe0",4:"31d6cfe0",5:"31d6cfe0",6:"1824b1f2",7:"31d6cfe0",8:"31d6cfe0",9:"31d6cfe0",10:"31d6cfe0",11:"31d6cfe0",12:"31d6cfe0",13:"31d6cfe0",14:"31d6cfe0",15:"31d6cfe0"}[l]+".chunk.css",o=s.p+t,r=document.getElementsByTagName("link"),a=0;a<r.length;a++){var c=(f=r[a]).getAttribute("data-href")||f.getAttribute("href");if("stylesheet"===f.rel&&(c===t||c===o))return e()}var u=document.getElementsByTagName("style");for(a=0;a<u.length;a++){var f;if((c=(f=u[a]).getAttribute("data-href"))===t||c===o)return e()}var i=document.createElement("link");i.rel="stylesheet",i.type="text/css",i.onload=e,i.onerror=function(e){var t=e&&e.target&&e.target.src||o,r=new Error("Loading CSS chunk "+l+" failed.\n("+t+")");r.request=t,n(r)},i.href=o,document.getElementsByTagName("head")[0].appendChild(i)}).then(function(){u[l]=0}));var r=d[l];if(0!==r)if(r)e.push(r[2]);else{var t=new Promise(function(e,t){r=d[l]=[e,t]});e.push(r[2]=t);var n,o=document.getElementsByTagName("head")[0],a=document.createElement("script");a.charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.src=s.p+"static/js/"+({}[l]||l)+"."+{0:"0206793b",2:"62eb3000",3:"c7af5567",4:"8dd27aae",5:"4600a1b2",6:"990c5257",7:"30ea74c0",8:"7512e075",9:"ebbe1e98",10:"abf27806",11:"0908009d",12:"3054338b",13:"d124050a",14:"25c1c560",15:"bec5874a"}[l]+".chunk.js",n=function(e){a.onerror=a.onload=null,clearTimeout(c);var t=d[l];if(0!==t){if(t){var r=e&&("load"===e.type?"missing":e.type),n=e&&e.target&&e.target.src,o=new Error("Loading chunk "+l+" failed.\n("+r+": "+n+")");o.type=r,o.request=n,t[1](o)}d[l]=void 0}};var c=setTimeout(function(){n({type:"timeout",target:a})},12e4);a.onerror=a.onload=n,o.appendChild(a)}return Promise.all(e)},s.m=f,s.c=r,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(r,n,function(e){return t[e]}.bind(null,n));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/",s.oe=function(e){throw console.error(e),e};var t=window.webpackJsonp=window.webpackJsonp||[],n=t.push.bind(t);t.push=e,t=t.slice();for(var o=0;o<t.length;o++)e(t[o]);var p=n;i()}([])</script><script src="/static/js/16.685cfdbc.chunk.js"></script><script src="/static/js/main.c79bbdec.chunk.js"></script></body></html>